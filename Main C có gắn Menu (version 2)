#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void);
struct product
{
	int id;
	char product_name[30];
	int remain;
	float price;
};

struct cart
{
	int id;
	char product_id[30];
	char pruct_name[30];
	float price;
	float sum;
	char coupon[30];
	float final_sum;
	int user_id;
};

struct user
{
	int id;
	char name[30];
	char address[30];
	int phone_number;
};

struct order
{
	int id;
	char product_id[30];
	char product_name[30];
	float price;
	float final_sum;
	char payment[100];
	char status[30];
	int user_id;
	int cart_id;
};

#define MAX_NAME_LENGTH 100
#define MAX_ADDRESS_LENGTH 200
#define MAX_PHONE_LENGTH 20
#define MAX_ITEMS 10

//import data from product.csv
void readProduct(struct product *Arrproduct, int *number)
{
	FILE *file;
	file = fopen("E:/Project C/product.csv", "r");
	if (file == NULL)
	{
		printf("Can't open file\n");
	}
	else
	{
		while (!feof(file))
		{
			fscanf(file, "%d,%c,%d,%f\n", &Arrproduct[*number].id);
			fscanf(file, "%c",Arrproduct[*number].product_name);
			fscanf(file, "%d", &Arrproduct[*number].remain);
			fscanf(file, "%f", &Arrproduct[*number].price);
			(*number)++;
		}
	}
	fclose(file);
}

//show product
void showProduct(struct product *Arrproduct, int number)
{
	for (int i = 0; i < number; i++)
	{
		printf("ID: %d\n", Arrproduct[i].id);
		printf("Product name: %s\n", Arrproduct[i].product_name);
		printf("Remain: %d\n", Arrproduct[i].remain);
		printf("Price: %f\n", Arrproduct[i].price);
	}
}

void MainMenu()
{
	printf("=============ONLINE SALES SYSTEM==============");
	printf("Menu:\n");
	printf("0.Exit.\n");
	printf("1.Select goods.\n");
	printf("2.Cart.\n");
	printf("==============================================");
} 

void MenuSales()
{
	printf("***************List of goods****************");
	printf("--------------------------------------------");
	printf("");
	printf("0.Exit.");
	printf("1.Move to cart.");
	printf("********************************************");
}

void CheckCart()
{
	printf("**************Your cart***************\n");
	printf("0.Exit.\n");
	printf("1.Inspection of selected goods.");
	printf("2.Choice of payment method.\n");
	printf("3.REMOVE CART");
	printf("**************************************\n");
}

void enterUserInfo(struct user *user) {
    printf("Enter your Id: ");
    scanf("%d", &user->id);
	
    printf("Your name: ");
    scanf("%s", user->name);
	
    printf("Your address: ");
    scanf("%s", user->address);
	
    printf("Phone number: ");
    scanf("%s", user->phone_number);
}

//-----------------------------------------------------------------------
int main()
{
	int option = 0, number = 0;
	struct product Arrproduct[1000];
	readProduct(Arrproduct, &number);
	do{
		MainMenu();
		printf("Choose your option: ");
		scanf("%d", &option);
		switch (option){
			case 0:{
				printf("You have exited the sales page!\n");
				break;
			}
			case 1:{
			showProduct(Arrproduct, number);
			MenuSales();
			// lua chon mat hang mong muon 
			printf("Select goods:");
			//Lua chon cach thoat trang mua hang sau khi mua xong 
			int opt=0;
			do{
				printf("0.Exit.\n");
				printf("1.Move to cart.\n");
				printf("Choose your option:");
				scanf("%d", &opt); // Fix: Read the option as an integer
				switch (opt){
					case 0:{ //thoat ra trang chu 
						printf("EXITED!");
						break;
					}
					case 1:{// di chuyen thang sang gio hang
						printf("MOVETED TO CART!");
						break;
					}
					default:{
						printf("Invalid option! Please choose again!");
						break;
					}
				}
			}while(opt != 0);
			break;
		}
			case 2:{//kiem tra gio hang 
			    int opt = 0;
			    do{
			    	CheckCart();
			    	printf("Choose your option: ");
			        printf("%d",&opt);
		    	    switch(opt){
			    	case 0:{
			    		printf("You have exited the cart!\n");
						break;
					}
					case 1:{//kiem tra mat hang 
						
						break;
					}
					case 2:{
					struct user user;
					enterUserInfo(&user);
						int opt;
						printf("Payment methods.");
						printf("0.Exit.");
						printf("1.Online payment.");
						printf("2.Offline payment.");
						printf("Choice of payment method:");
						do{
							switch(opt){
								case 0:{
									printf("EXITED.");
									break;
								}
								case 1:{//chuyen sang giao dien thanh toan online
									
									break;
								}
								case 2:{
									printf("Thanks for buying!");
									break;
								}
								default:{
									printf("Invalid option! Please choose again!");
									break;
								}
							}
						}while(opt != 0);
						break;
				    }
			     case 3:{// xoa gio hang 
						
						
						break;
					}
					default:{
						printf("Invalid option! PLease choose again!\n");
						break;
					}
				}
				}while(opt != 0);
				break;
			}
			default:{
				printf("Invalid option! Please choose again!\n");
				break;
			}
		}
	}while (option != 0);
	
}
